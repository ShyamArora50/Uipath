<
                <OutArgument x:TypeArguments="x:String">[Query]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[in_Config("DB_ReportUpdate").ToString]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:DatabaseConnect DatabaseConnection="[DBConnection]" DisplayName="Connecting to database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="DatabaseConnect_3" ProviderName="System.Data.SqlClient" ConnectionString="[in_Config(&quot;DB_ConnString&quot;).ToString]">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:DatabaseConnect>
            <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="262,61" sap2010:WorkflowViewState.IdRef="WriteLine_5" Text="[Query]" />
            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DisplayName="Execute Non Query" ExistingDbConnection="[DBConnection]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_1" Sql="[Query]">
              <ui:ExecuteNonQuery.Parameters>
                <scg:Dictionary x:TypeArguments="x:String, Argument" />
              </ui:ExecuteNonQuery.Parameters>
            </ui:ExecuteNonQuery>
            <ui:DatabaseDisconnect DatabaseConnection="[DBConnection]" DisplayName="Disconnect" sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="DatabaseDisconnect_3" />
          </Sequence>
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;Reporting completed&quot;]">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:LogMessage>
        </Sequence>
      </If.Then>
      <If.Else>
        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Trace" Message="[&quot;Reporting not required&quot;]">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </ui:LogMessage>
      </If.Else>
    </If>
  </Sequence>
</Activity>


SELECT Sum(IIF([Status] = 'Response Awaited from RM',1,0)) as [Aawaiting], Sum(IIF(CHARINDEX('Request Forwarded to CCS',[Status]) > 0,1,0)) as [Forwarded], Sum(IIF([Status] = 'Request Rejected on BPMS',1,0)) as [Rejected], Sum(IIF([Status] = 'Response Awaited from RM',1,0)) as [Approved], count(*) as [Total],Min([OpenDateTime]) as [FROM],Max([OpenDateTime]) as [FROM]  FROM [Bot_BPMS_FinExpApv].[dbo].[tbl_BotDB] WHERE [IsReported] = 'False' AND [Status] <> 'New'
